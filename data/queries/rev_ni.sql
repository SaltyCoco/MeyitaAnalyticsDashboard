-- data/queries/rev_ni.sql

SELECT
    a.company_name,
    a.symbol,
    a.ni_2010,
    a.ni_2011,
    a.ni_2012,
    a.ni_2013,
    a.ni_2014,
    a.ni_2015,
    a.ni_2016,
    a.ni_2017,
    a.ni_2018,
    a.ni_2019,
    b.rev_2010,
    b.rev_2011,
    b.rev_2012,
    b.rev_2013,
    b.rev_2014,
    b.rev_2015,
    b.rev_2016,
    b.rev_2017,
    b.rev_2018,
    b.rev_2019,
    b.rev_2010 - a.ni_2010 diff_ni_rev_2010,
    b.rev_2011 - a.ni_2011 diff_ni_rev_2011,
    b.rev_2012 - a.ni_2012 diff_ni_rev_2012,
    b.rev_2013 - a.ni_2013 diff_ni_rev_2013,
    b.rev_2014 - a.ni_2013 diff_ni_rev_2014,
    b.rev_2015 - a.ni_2015 diff_ni_rev_2015,
    b.rev_2016 - a.ni_2016 diff_ni_rev_2016,
    b.rev_2017 - a.ni_2017 diff_ni_rev_2017,
    b.rev_2018 - a.ni_2018 diff_ni_rev_2018,
    b.rev_2019 - a.ni_2019 diff_ni_rev_2019,
--     b.rev_2010 / a.ni_2010 pct_ni_rev_2010,
--     b.rev_2011 / a.ni_2011 pct_ni_rev_2011,
--     b.rev_2012 / a.ni_2012 pct_ni_rev_2012,
--     b.rev_2013 / a.ni_2013 pct_ni_rev_2013,
--     b.rev_2014 / a.ni_2013 pct_ni_rev_2014,
--     b.rev_2015 / a.ni_2015 pct_ni_rev_2015,
--     b.rev_2016 / a.ni_2016 pct_ni_rev_2016,
--     b.rev_2017 / a.ni_2017 pct_ni_rev_2017,
--     b.rev_2018 / a.ni_2018 pct_ni_rev_2018,
--     b.rev_2019 / a.ni_2019 pct_ni_rev_2019,
    c.gd_rating,
    c.gd_app_ceo,
    c.gd_rec_to_fri,
    c.gd_num_reviews,
    c.gd_benefits,
    c.ind_work_life,
    c.ind_pay_ben,
    c.ind_job_sec_adv,
    c.ind_mgnt,
    c.ind_culture,
    c.ind_salary_sat,
    c.ind_app_ceo
FROM postgres.public.net_income a
LEFT JOIN postgres.public.revenue b ON b.symbol = a.symbol
LEFT JOIN postgres.public.employee_rating c ON b.symbol = c.symbol